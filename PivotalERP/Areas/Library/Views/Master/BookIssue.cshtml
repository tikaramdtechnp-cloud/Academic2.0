<style>

    .t-h-10 .table td, .t-h-10 .table th {
        line-height: 1;
        padding: 0.5rem !important;
        font-size: 0.7875rem !important;
    }

    .panel-title > a, .panel-title > a:active {
        font-family: "IBM Plex Sans", sans-serif;
        display: block;
        padding: 8px 15px;
        color: #2D3333;
        font-size: 0.813rem;
        font-weight: bold;
        letter-spacing: 1px;
        word-spacing: 3px;
        text-decoration: none;
    }

    .snj-panel .panel-title a {
        display: block;
        text-decoration: none;
        background: #E9F2EE;
    }
</style>
@*<link href="~/wwwroot/dynamic/css/library.css" rel="stylesheet" />*@
<script src="~/jslib/Library/BookIssue.js?v=20251115"></script>

<div class="hold-transition  layout-navbar-fixed" ng-app="myApp" ng-controller="BookIssueController" ng-init="LoadData()">
    <section class="content">
        <div class="container-fluid">
            <section class="iframe-content-starts-here main-section" style="margin-top:5px;">
                <div class="row">
                    <div class="col-md-9">

                        <div class="row ">
                            <div class="col-md-2">
                                <div class="form-group">
                                    <label for="">Issue No</label>
                                    <input type="text" class="form-control form-control-sm" ng-model="newBookIssue.IssueNo" readonly>
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="form-group">
                                    <label for="">Issue Date</label>
                                    <input type="text" class="form-control form-control-sm" ng-model="newBookIssue.IssueDate_TMP" date-picker date-detail="newBookIssue.IssueDateDet" readonly>
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="form-group">
                                    <label>Issue To</label>
                                    <select class="form-control form-control-sm" ng-model="newBookIssue.IssueTo">
                                        <option ng-value="it.id" ng-repeat="it in IssueToList" ng-selected="it.id==newBookIssue.IssueTo">{{it.text}}</option>
                                    </select>
                                </div>
                            </div>


                            <div class="col-sm-6 col-lg-6 col-md-6 mt-4" ng-show="newBookIssue.IssueTo==2" id="selectEmp">
                                <label class="sr-only" for="inlineFormInputGroup">Select Employee</label>

                                <div class="input-group-prepend">
                                    <select class="input-group-text dropdown-toggle p-0"
                                            style="outline: none;
                                                            border-top-right-radius: unset;
                                                            border-bottom-right-radius: unset;
                                                            margin-right: -3px;
                                                            z-index: 1;
                                                            font-size: 13px;
                                                    " ng-model="newBookIssue.SelectEmployee">

                                        <option class="dropdown-item" ng-repeat="ss in EmployeeSearchOptions" ng-value="ss.value" ng-selected="ss.value==newBookIssue.SelectEmployee">
                                            {{ss.text}}
                                        </option>

                                    </select>

                                    <select class="form-control select2 form-control-sm" all-employee ng-model="newBookIssue.EmployeeId" employee-detail="newBookIssue.EmployeeDetails" side-bar-data="newBookIssue.EmpSideBarData" search-by="newBookIssue.SelectEmployee" style="width: 100%;" confirm-action="getTeachCreditRule()">
                                    </select>

                                </div>
                            </div>
                            <div class="col-sm-6 col-lg-6 col-md-6" ng-show="newBookIssue.IssueTo==1" id="selectStu">

                                <div class="custom-control custom-checkbox text-right">
                                    <input class="custom-control-input" type="checkbox" ng-model="newBookIssue.ShowLeftStudent"
                                           id="customCheckbox111" value="option1">
                                    <label for="customCheckbox111"
                                           class="custom-control-label">
                                        Show Left Student
                                    </label>
                                </div>
                                <div class="input-group-prepend">
                                    <select class="input-group-text dropdown-toggle p-0"
                                            style="outline: none;
                                                            border-top-right-radius: unset;
                                                            border-bottom-right-radius: unset;
                                                            margin-right: -3px;
                                                            z-index: 1;
                                                            font-size: 13px;
                                                    " ng-model="newBookIssue.SelectStudent">

                                        <option ng-repeat="ss in StudentSearchOptions" ng-value="ss.value" ng-selected="ss.value==newBookIssue.SelectStudent">
                                            {{ss.text}}
                                        </option>

                                    </select>

                                    <select class="form-control select2 form-control-sm" all-student ng-model="newBookIssue.StudentId" student-detail="newBookIssue.StudentDetails" side-bar-data="newBookIssue.SideBarData" search-by="newBookIssue.SelectStudent" confirm-action="getDuesDetails()" include-left="newBookIssue.ShowLeftStudent">
                                    </select>

                                </div>
                            </div>


                        </div>
                        <div class="" ng-show="newBookIssue.IssueTo==1" id="stu_dues" style="margin-top: -5px;">
                            <div class="">
                                <label class="float-right">Dues Fee : {{CurDues.TotalDues |number:2}}/-</label>
                                <!-- <button class="btn btn-sm btn-info float-right" style="min-width:90px;padding: 3px; font-size: 12px;" data-toggle="modal" data-target="#feedetail">Show Details</button> -->
                            </div>
                        </div>


                        <div class="table-section">
                            <div class="card-tools" style="margin-bottom: -15px;">
                                <label class=""><b>Previous Book Record</b></label> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                                <label for="" class="align-items-center"><b>Total Pending : {{PreviousBookDetailsColl.length}}</b></label>
                            </div>


                            <div class="table-scroll-x-y sales-main-table table-scroll mb-4 mt-4 t-h-10">
                                <table id="main-table" class="main-table table table-sm bg-white order-list">
                                    <thead>
                                        <tr>
                                            <th>S.No</th>
                                            <th>Accession No.</th>
                                            <th>Title</th>
                                            <th>Issue Date</th>
                                            <th>Credit Days</th>
                                            <th>outstanding days</th>

                                            <th style="width: 85px;">Fine Amount</th>

                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="pbr in PreviousBookDetailsColl">
                                            <td>{{$index+1}}</td>
                                            <td>{{pbr.AccessionNo}}</td>
                                            <td>{{pbr.BookTitle}}</td>
                                            <td>{{pbr.IssueDate_BS}}</td>
                                            <td>{{pbr.CreditDays}}</td>
                                            <td>{{pbr.OutStandingDays}}</td>
                                            <td>{{pbr.FineAmt |number:2}}</td>
                                        </tr>

                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="table-section mt-2">
                            <div class="card-tools" style="margin-bottom:-10px">
                                <div class="row ">
                                    <div class="col-md-7">
                                        <div class="input-group-prepend">
                                            <select class="input-group-text dropdown-toggle p-0"
                                                    style="outline: none;
                                                            border-top-right-radius: unset;
                                                            border-bottom-right-radius: unset;
                                                            margin-right: -3px;
                                                            z-index: 1;
                                                            font-size: 13px;
                                                    " ng-model="newBookIssue.SelectBook">

                                                <option ng-repeat="ss in BookSearchOptions" ng-value="ss.value" ng-selected="ss.value==newBookIssue.SelectBook">
                                                    {{ss.text}}
                                                </option>

                                            </select>

                                            <select class="form-control select2 form-control-sm" all-book ng-model="newBookIssue.BookEntryId" book-detail="newBookIssue.BookDetails" side-bar-data="newBookIssue.SideBarData" search-by="newBookIssue.SelectBook" confirm-action="ShowBookDetails()">
                                            </select>

                                        </div>

                                    </div>
                                    <!--Field added by suresh on 25 kartik starts-->
                                    <div class="col-md-4">
                                        <div class="form-group d-flex">
                                            <label class="mr-1 mt-1 text-nowrap">Scan Barcode</label>
                                            <input type="text" class="form-control form-control-sm" style="width:70%;" ng-model="newBookIssue.Barcode">
                                        </div>
                                    </div>
                                    <!--ends-->
                                    <div class="col-md-1">
                                        <button type="button" class="btn btn-sm btn-outline-secondary light-btn" style="min-width: 60px;" ng-click="AddBookForIssue()">
                                            <i class="fas fa-plus"></i> Add
                                        </button>
                                    </div>
                                </div>

                            </div>

                            <div class="table-scroll-x-y sales-main-table table-scroll mb-4 mt-4 t-h-10">
                                <table id="main-table" class="main-table table table-sm bg-white order-list">
                                    <thead class=" text-nowrap">
                                        <tr>
                                            <th style="width:50px">S.No</th>
                                            <th style="width:50px">Accession No.</th>
                                            <th style="width:200px">Title</th>

                                            <th style="width:80px">Credit Days</th>

                                            <th style="width:200px">Remarks</th>
                                            <th style="text-align: center; width: 60px;">Action</th>

                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="ba in newBookIssue.DetailsColl">
                                            <td>{{$index+1}}</td>
                                            <td>{{ba.BookDet.AccessionNo}}</td>
                                            <td>{{ba.BookDet.BookTitle}}</td>

                                            <td>
                                                <input type="number" class="form-control form-control-sm" ng-model="ba.CreditDays" style="height:25px" />
                                            </td>

                                            <td>
                                                <input type="text" class="form-control form-control-sm" ng-model="ba.IssueRemarks" style="height:25px" />
                                            </td>

                                            <td class="text-center">
                                                @*<a class="p-1" ng-click="AddBookIssueDetails($index)">
                                                        <i class="fas fa-plus text-secondary"></i>
                                                    </a>*@

                                                <a class="p-1" ng-click="delBookIssueDetails($index)">
                                                    <i class="fas fa-trash-alt text-danger"></i>
                                                </a>
                                            </td>

                                        </tr>

                                    </tbody>
                                </table>
                            </div>
                        </div>


                        <div class="time-label">
                            <span class="d-block border-0 p-3 text-center">
                                <button type="button" class="btn btn-sm btn-default" style="min-width: 90px;" ng-click="ClearBookIssue()">Reset</button>
                                <button type="button" class="btn btn-sm btn-success" style="min-width: 90px;" ng-click="SaveUpdateBookIssue()">{{newBookIssue.Mode}}</button>
                            </span>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="wrapper ">
                            <div class="panel-group snj-panel" id="accordion" role="tablist" aria-multiselectable="true">
                                <div class="panel panel-default" id="stu_Details" ng-show="newBookIssue.IssueTo==1">
                                    <div class="panel-heading active" role="tab" id="headingOne">
                                        <h4 class="panel-title">
                                            <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseOne"
                                               aria-expanded="true" aria-controls="collapseOne">
                                                Student Details
                                            </a>
                                        </h4>
                                    </div>
                                    <div id="collapseOne" class="panel-collapse collapse in show" role="tabpanel"
                                         aria-labelledby="headingOne">
                                        <div class="panel-body">
                                            <div class="col-sm-12 col-md-12 col-lg-12">
                                                <div class="row">
                                                    <div class="col-sm-4 col-md-4 col-lg-4">
                                                        @*<img src="~/wwwroot/dynamic/images/fee_receipt/profile_30.png">*@
                                                        <img style="height:50px; width:50px;" class="rounded-circle" ng-src="{{CurDues.PhotoPath}}" />
                                                    </div>
                                                    <div class="col-sm-8 col-md-8 col-lg-8">
                                                        <span class="s-text">Name</span><br>
                                                        <span><b>{{CurDues.Name}}</b></span><br>
                                                    </div>
                                                </div>
                                                <div class="row mt-2">
                                                    <div class="col-sm-7 col-md-7 col-lg-7">
                                                        <span class="s-text">Adm. No.: </span>
                                                        <b>  <span>{{CurDues.RegdNo}}</span></b>
                                                    </div>
                                                    <div class="col-sm-5 col-md-5 col-lg-5">
                                                        <span class="s-text">Roll :</span>
                                                        <b> <span>{{CurDues.RollNo}}</span></b>
                                                    </div>
                                                    <div class="col-sm-12 col-md-12 col-lg-12">
                                                        <span>
                                                            Class: <b>
                                                                <span>
                                                                    {{CurDues.ClassName ? CurDues.ClassName : ''}}
                                                                    {{CurDues.SectionName ? ' - ' + CurDues.SectionName : ''}}
                                                                    {{CurDues.Batch ? ' - ' + CurDues.Batch : ''}}
                                                                    {{CurDues.Semester ? ' - ' + CurDues.Semester : ''}}
                                                                    {{CurDues.ClassYear ? ' - ' + CurDues.ClassYear : ''}}
                                                                </span>
                                                            </b>
                                                        </span>
                                                        @*<span class="s-text">Class/Sec.</span><br>
                                                            <span>{{CurDues.ClassName}} {{CurDues.SectionName}}</span>*@
                                                    </div>
                                                </div>

                                                <div class="row mt-2">
                                                    <div class="col-sm-12 col-md-12 col-lg-12">
                                                        <span class="s-text">Address : </span>
                                                        <b> <span>{{CurDues.Address}}</span></b>
                                                    </div>
                                                    <div class="col-sm-12 col-md-12 col-lg-12">
                                                        <span class="s-text">Father Name : </span>
                                                        <b> <span>{{CurDues.FatherName}}</span></b>
                                                    </div>
                                                    <div class="col-sm-12 col-md-12 col-lg-12">
                                                        <span class="s-text">Contact : </span>
                                                        <b>  <span>{{CurDues.ContactNo}}</span></b>
                                                    </div>
                                                </div>
                                                <!--Field added by suresh on 25 kartik starts-->
                                                <div class="row mt-2">
                                                    <div class="col-sm-4 col-md-4 col-lg-4">
                                                        <span class="s-text">Book Limit</span><br>
                                                        <span>{{CurDues.BookLimit}}</span>
                                                    </div>
                                                    <div class="col-sm-4 col-md-4 col-lg-4">
                                                        <span class="s-text">Credit Days</span><br>
                                                        <span>{{CurDues.BookCreditDays}}</span>
                                                    </div>

                                                </div>
                                                <!--ends-->

                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="panel panel-default" id="emp_Details" ng-show="newBookIssue.IssueTo==2">
                                    <div class="panel-heading active" role="tab" id="headingOne">
                                        <h4 class="panel-title">
                                            <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseOne"
                                               aria-expanded="true" aria-controls="collapseOne">
                                                Employee Details
                                            </a>
                                        </h4>
                                    </div>
                                    <div id="collapseOne" class="panel-collapse collapse in show" role="tabpanel"
                                         aria-labelledby="headingOne">
                                        <div class="panel-body">
                                            <div class="col-sm-12 col-md-12 col-lg-12">
                                                <div class="row">
                                                    <div class="col-sm-4 col-md-4 col-lg-4">
                                                        <img ng-src="{{DefaultPhoto}}" style="height:50px; width:50px;" class="rounded-circle" />
                                                    </div>
                                                    <div class="col-sm-4 col-md-4 col-lg-4">
                                                        <span><b>{{newBookIssue.EmployeeDetails.Name}}</b></span><br>
                                                        <span>{{newBookIssue.EmployeeDetails.Designation}}</span>
                                                    </div>
                                                    <div class="col-sm-4 col-md-4 col-lg-4">
                                                        <span class="s-text">Employee Code</span><br>
                                                        <span>{{newBookIssue.EmployeeDetails.Code}}</span>
                                                    </div>
                                                </div>
                                                <div class="row mt-2">
                                                    <div class="col-sm-4 col-md-4 col-lg-4">
                                                        <span class="s-text">Contact No.</span><br>
                                                        <span>{{newBookIssue.EmployeeDetails.MobileNo}}</span>
                                                    </div>
                                                    <div class="col-sm-4 col-md-4 col-lg-4">
                                                        <span class="s-text">Address</span><br>
                                                        <span>{{newBookIssue.EmployeeDetails.Address}}</span>
                                                    </div>
                                                    <div class="col-sm-4 col-md-4 col-lg-4">
                                                        <span class="s-text">Subject Teacher</span><br>
                                                        <span>{{newBookIssue.EmployeeDetails.SubjectTeacher}}</span>
                                                    </div>
                                                </div>

                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="panel panel-default">
                                    <div class="panel-heading current_due" role="tab" id="headingThree">
                                        <h4 class="panel-title mb-0">
                                            <a class="collapsed" role="button" data-parent="#accordion" href="javascript:void(0)"
                                               aria-expanded="false" aria-controls="collapseThree">
                                                Book Details
                                            </a>
                                        </h4>
                                    </div>
                                    <div id="collapseThree" class="panel-collapse collapse show" role="tabpanel"
                                         aria-labelledby="headingThree">
                                        <div class="panel-body">
                                            <div class="col-md-12" style="font-size: 0.7rem;">
                                                <div class="row">
                                                    <div class="col-sm-9 col-md-9 col-lg-9">
                                                        <span><b>Book Title</b></span><br>
                                                        <span>{{newBookIssue.BookDetails.BookTitle}}</span>
                                                    </div>
                                                    <div class="col-sm-3 col-md-3 col-lg-3 float-right">
                                                        <a href="#" data-target="#modalIMG-general" data-toggle="modal" class="color-gray-darker c6 td-hover-none ">
                                                            <div class="ba-0 ds-1">
                                                                <img ng-src="{{newBookIssue.BookDetails.FrontCoverPath}}" style="height: 60px; width: 100%;">

                                                            </div>
                                                        </a>
                                                        <div aria-hidden="true" aria-labelledby="myModalLabel" class="modal fade" id="modalIMG-general" role="dialog" tabindex="-1">
                                                            <div class="modal-dialog modal-lg" role="document">
                                                                <div class="modal-content">
                                                                    <div class="modal-body mb-0 p-0">
                                                                        <img ng-src="{{newBookIssue.BookDetails.FrontCoverPath}}" alt="" style="width:100%; height: 30vh;" class="d-flex mx-auto">
                                                                    </div>
                                                                    <div class="modal-footer">
                                                                        <!-- <div><a href="dynamic/images/book-1.png" target="_blank" download>Download</a></div> -->
                                                                        <button class="btn btn-success btn-rounded btn-sm ml-4 text-center" data-dismiss="modal" type="button" style="min-width: 90px;">Close</button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="col-sm-4 col-md-4 col-lg-4 " style="margin-top: -15px;">
                                                        <span class="s-text"><b>Bar Code</b></span><br>
                                                        <span>{{newBookIssue.BookDetails.Barcode}}</span>
                                                    </div>
                                                    <div class="col-sm-4 col-md-4 col-lg-4 " style="margin-top: -15px;">
                                                        <span class="s-text"><b>Subject</b></span><br>
                                                        <span>{{newBookIssue.BookDetails.Subject}}</span>
                                                    </div>


                                                </div>
                                                <div class="row mt-3">
                                                    <div class="col-sm-8 col-md-8 col-lg-8">
                                                        <span class="s-text"><b>Authors</b></span><br>
                                                        <span>{{newBookIssue.BookDetails.Authors}}</span>
                                                    </div>
                                                    <div class="col-sm-4 col-md-4 col-lg-4">
                                                        <span class="s-text"><b>Credit Days</b></span><br>
                                                        <span>{{newBookIssue.BookDetails.CreditDays}} Days</span>
                                                    </div>
                                                    <div class="col-sm-12 col-md-12 col-lg-12 mt-3">
                                                        <span class="s-text"><b>Publisher</b></span><br>
                                                        <span>{{newBookIssue.BookDetails.Publication}}</span>
                                                    </div>
                                                    <div class="col-sm-12 col-md-12 col-lg-12 mt-3">
                                                        <span class="s-text"><b>Category</b></span><br>
                                                        <span>{{newBookIssue.BookDetails.BookCategory}}</span>
                                                    </div>
                                                </div>
                                                <div class="row mt-3">
                                                    <div class="col-sm-4 col-md-4 col-lg-4">
                                                        <span class="s-text"><b>Level</b></span><br>
                                                        <span>{{newBookIssue.BookDetails.ClassName}}</span>
                                                    </div>
                                                    <div class="col-sm-4 col-md-4 col-lg-4 ">
                                                        <span class="s-text"><b>Department</b></span><br>
                                                        <span>{{newBookIssue.BookDetails.Department}}</span>
                                                    </div>
                                                    <!--Field added by suresh on 25 kartik starts-->
                                                    <div class="col-sm-4 col-md-4 col-lg-4 ">
                                                        <span class="s-text"><b>Class</b></span><br>
                                                        <span>{{newBookIssue.BookDetails.ClassName}}</span>
                                                    </div>
                                                    <!--ends-->
                                                </div>


                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>

                    </div>
                </div>

            </section>
            <!-- /.row -->
        </div>
        <!--/. container-fluid -->
    </section>
</div>







