<style>
    .card-head {
        padding: 0px 15px !important;
    }
</style>
<link href="~/wwwroot/dynamic/css/lessonplan.css" rel="stylesheet" />
<script src="~/jslib/ELearning/AddLessonPlanning.js"></script>
<div class="hold-transition  layout-navbar-fixed" ng-app="myApp" ng-controller="LessonPlanController" ng-init="LoadData()">
    <section class="content">
        <div class="container-fluid">
            <section class="iframe-content-starts-here">
                <div class="tab-content" id="pills-tabContent">
                    <div class="tab-pane fade show active" id="pills-second" role="tabpanel"
                         aria-labelledby="pills-second-tab">
                        <header class="if-page-have-nav-tabs px-2">
                            <div class="row upper-tab">
                                <div class="col-md-12">
                                    <ul class="nav nav-tabs cstm-nav-tabs-border-bottom-active" id="myTab"
                                        role="tablist">                                        
                                        <li class="nav-item" role="presentation">
                                            <a class="nav-link active" id="contact-tab" data-toggle="tab"
                                               href="#contact" role="tab" aria-controls="contact"
                                               aria-selected="false">Add Lesson Plan</a>
                                        </li>
                                        <li class="nav-item" role="presentation">
                                            <a class="nav-link" id="board-tab" data-toggle="tab"
                                               href="#board" role="tab" aria-controls="board"
                                               aria-selected="false">List Of Lesson Plan</a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </header>
                        <!-- end if-page-have-nav-tabs -->
                        <div class="tab-content" id="myTabContent">                            
                            <!--Add Lesson Plan Starts-->
                            <div class="tab-pane fade show active main-section" id="contact" role="tabpanel"
                                 aria-labelledby="contact-tab">
                                <div class="container1">
                                    <div class="row mt-2">
                                        <div class="col-md-1" ng-show="AcademicConfig.ActiveBatch==true">
                                            <label for="">Batch</label>
                                            <select class="form-control form-control-sm select2" ng-model="newAddLessonPlan.BatchId">
                                                <option ng-value="0">**Select Batch**</option>
                                                <option ng-value="cl.id" ng-repeat="cl in BatchList" ng-selected="cl.id==newAddLessonPlan.BatchId">{{cl.text}}</option>
                                            </select>
                                        </div>
                                        @*<div class="col-md-3">
            <div class="form-group ">
                <label>Class</label>
                <select class="form-control form-control-sm select2" ng-model="newAddLessonPlan.ClassId" ng-change="GetClassWiseSubMap()">
                    <option ng-repeat="ct in ClassColl  track by $index" ng-value="{{ ct.ClassId }}" ng-selected="ct.ClassId==newAddLessonPlan.ClassId">
                        {{ct.Name}}
                    </option>
                </select>
            </div>
        </div>*@
                                        <div class="col-md-2">
                                            <div class="form-group mb-2">
                                                <label for="">Class</label>
                                                <select class="form-control form-control-sm select2" ng-model="newAddLessonPlan.SelectedClass" ng-change="GetClassWiseSubMap()">
                                                    <option ng-value="cl" ng-repeat="cl in ClassSection.ClassList">{{cl.text}}</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-group ">
                                                <label> Section</label>
                                                <select ng-model="newAddLessonPlan.SectionIdColl" ng-disabled="!newAcademic.SectionWiseLessonPlan" class="form-control form-control-sm select2" multiple="multiple" id="cboSection" name="cboSection" ng-change="GetClassWiseSubMap()">
                                                    <option ng-repeat="cl in SectionClassColl | filter: { ClassId: newAddLessonPlan.SelectedClass.ClassId }:true" value="{{cl.SectionId}}" ng-selected="{{newAddLessonPlan.SectionIdColl_TMP.containt(cl.SectionId)}}">
                                                        {{cl.SectionName}}
                                                    </option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-md-2" ng-show="newAddLessonPlan.SelectedClass.ClassType==2  &&  AcademicConfig.ActiveClassYear==true">
                                            <div class="form-group">
                                                <label for="">Class Year</label>
                                                <select class="form-control form-control-sm select2" ng-model="newAddLessonPlan.ClassYearId" ng-change="GetClassWiseSubMap()">
                                                    <option ng-value="0">**Select Year**</option>
                                                    <option ng-value="cl.id" ng-repeat="cl in ClassYearList" ng-selected="cl.id==newAddLessonPlan.ClassYearId">{{cl.text}}</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-md-2" ng-show="newAddLessonPlan.SelectedClass.ClassType==3 &&  AcademicConfig.ActiveSemester==true">
                                            <div class="form-group">
                                                <label for="">Semester</label>
                                                <select class="form-control form-control-sm select2" ng-model="newAddLessonPlan.SemesterId" ng-change="GetClassWiseSubMap()">
                                                    <option ng-value="0">**Select Semester**</option>
                                                    <option ng-value="cl.id" ng-repeat="cl in SemesterList" ng-selected="cl.id==newAddLessonPlan.SemesterId">{{cl.text}}</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="form-group">
                                                <label for="">Subject</label>
                                                <select class="form-control form-control-sm select2" ng-model="newAddLessonPlan.SubjectId" ng-change="GetLessonPlanByClassSubjectALP()">
                                                    <option ng-repeat="ct in newAddLessonPlan.SubjectList" value="{{ ct.SubjectId }}" ng-selected="ct.SubjectId==newAddLessonPlan.SubjectId">
                                                        {{ct.Name}}
                                                    </option>
                                                </select>
                                            </div>
                                        </div>


                                        <div class="col-md-2">
                                            <div class="float-right mt-4">
                                                <button type="button" class="btn btn-sm btn-default" style="min-width: 90px" ng-click="ClearLessonPlan()">
                                                    Reset
                                                </button>
                                                <button type="button" class="btn btn-sm btn-success" style="min-width: 90px" ng-click="CallSaveUpdateLessonPlanDate()">
                                                    Save
                                                </button>
                                            </div>
                                        </div>

                                    </div>
                                    <div class="accordion" id="accordionExample6" style="margin-top: 0;">
                                        <div class="card">
                                            <div  id="headingsix">
                                                <h2 class="mb-0 collapsed" @*data-toggle="collapse"
                                                    data-target="#collapsesix" aria-expanded="false"
                                                    aria-controls="collapsesix"*@>
                                                    <span class="acc_open">{{newAddLessonPlan.SubjectName}}</span>

                                                </h2>
                                            </div>
                                            <div id="collapsesix" class="collapse show"
                                                 aria-labelledby="headingsix" data-parent="#accordionExample2">
                                                <div class="card mt-3"
                                                     style="border:1px solid #cad8d2;margin-left:20px;">
                                                    <div class="card-header"
                                                         style="background-color: #e9f2ee; padding:4px 10px;">
                                                        <div class="row">
                                                            <div class="col-md-8">
                                                                <h6># Lessons and Topics</h6>
                                                            </div>
                                                            <div class="col-md-2">
                                                                <div class="text-center">
                                                                    <h6>From Date</h6>
                                                                </div>
                                                            </div>
                                                            <div class="col-md-2">
                                                                <div class="text-center">
                                                                    <h6>To Date</h6>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="card-body" style="padding-left: 20px;">
                                                        <div class="tab-pane active" id="tabs-1"
                                                             role="tabpanel" ng-repeat-start="ald in newAddLessonPlan.DetailsColl">
                                                            <p class="topic">
                                                                {{ald.SNo}}. {{ald.LessonName}}
                                                            </p>
                                                        </div>
                                                        <ul class="topic_section pl-2" ng-repeat-end>                                                            
                                                            <li class="past_section" ng-repeat="atd in ald.TopicColl">
                                                                <div class="row">
                                                                    <div class="col-md-9">
                                                                        <span style="top: -10px;">----</span><a href="#">{{ald.SNo}}.{{atd.SNo}}. {{atd.TopicName}} </a>
                                                                    </div>
                                                                    <div class="col-md-3">
                                                                        <div class="d-flex float-right ">
                                                                            <div id="lessondateip">
                                                                                <div class="row">
                                                                                    <div class="col-md-6">
                                                                                        <div class="d-flex">
                                                                                            <label class="mr-1 mt-1"></label>
                                                                                            <input type="text"
                                                                                                   class="form-control form-control-sm" date-picker ng-model="atd.PlanStartDate_TMP" date-detail="atd.PlanStartDateDet">
                                                                                        </div>
                                                                                    </div>
                                                                                    <div class="col-md-6">
                                                                                        <div class="d-flex">
                                                                                            <label class="mr-1 mt-1"></label>
                                                                                            <input type="text"
                                                                                                   class="form-control form-control-sm" date-picker ng-model="atd.PlanEndDate_TMP" date-detail="atd.PlanEndDateDet">
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                            <i class="far fa-calendar-alt ml-2 mt-2" ng-if="atd.TranId"  id="topiccalender"
                                                                               @*data-toggle="modal" data-target="#modal-xl"*@ ng-click="ClickOnTopic(ald,atd)"></i>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                    </div>

                                </div>
                            </div>
                            <!--Add Lesson Plan Ends-->
                            <!--List Of Lesson Plan Starts-->
                            <div class="tab-pane fade main-section" id="board" role="tabpanel"
                                 aria-labelledby="board-tab">
                                <div class="row">
                                    <div class="col-md-1" ng-show="AcademicConfig.ActiveBatch==true">
                                        <label for="">Batch</label>
                                        <select class="form-control form-control-sm select2" ng-model="newListOfLessonPlan.BatchId">
                                            <option ng-value="0">**Select Batch**</option>
                                            <option ng-value="cl.id" ng-repeat="cl in BatchList" ng-selected="cl.id==newListOfLessonPlan.BatchId">{{cl.text}}</option>
                                        </select>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="form-group">
                                            <label>Class</label>
                                            @*<select class="form-control form-control-sm select2" ng-model="newListOfLessonPlan.ClassId" ng-change="GetClassWiseSubjectListForLLP(newListOfLessonPlan.ClassId)">
                    <option ng-value="0">Select Class</option>
                    <option ng-value="cl.id" ng-repeat="cl in ClassSection.ClassList" ng-selected="cl.id==newListOfLessonPlan.ClassId">{{cl.text}}</option>
                </select>*@
                                            <select class="form-control form-control-sm select2" ng-model="newListOfLessonPlan.SelectedClass" ng-change="GetClassWiseSubMapRep()">
                                                <option ng-value="cl" ng-repeat="cl in ClassSection.ClassList">{{cl.text}}</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="col-md-3">
                                        <div class="form-group ">
                                            <label> Section</label>
                                            <select ng-model="newListOfLessonPlan.SectionIdColl" ng-disabled="!newAcademic.SectionWiseLessonPlan" class="form-control form-control-sm select2" multiple="multiple" id="cbooSection" name="cbooSection" ng-change="GetClassWiseSubMapRep()">
                                                <option ng-repeat="cl in SectionClassColl | filter: { ClassId: newListOfLessonPlan.SelectedClass.ClassId }:true" value="{{cl.SectionId}}" ng-selected="{{newListOfLessonPlan.SectionIdColl_TMP.containt(cl.SectionId)}}">
                                                    {{cl.SectionName}}
                                                </option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-2" ng-show="newListOfLessonPlan.SelectedClass.ClassType==2  &&  AcademicConfig.ActiveClassYear==true">
                                        <div class="form-group">
                                            <label for="">Class Year</label>
                                            <select class="form-control form-control-sm select2" ng-model="newListOfLessonPlan.ClassYearId" ng-change="GetClassWiseSubMapRep()">
                                                <option ng-value="0">**Select Year**</option>
                                                <option ng-value="cl.id" ng-repeat="cl in ClassYearList" ng-selected="cl.id==newListOfLessonPlan.ClassYearId">{{cl.text}}</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-2" ng-show="newListOfLessonPlan.SelectedClass.ClassType==3 &&  AcademicConfig.ActiveSemester==true">
                                        <div class="form-group">
                                            <label for="">Semester</label>
                                            <select class="form-control form-control-sm select2" ng-model="newListOfLessonPlan.SemesterId" ng-change="GetClassWiseSubMapRep()">
                                                <option ng-value="0">**Select Semester**</option>
                                                <option ng-value="cl.id" ng-repeat="cl in SemesterList" ng-selected="cl.id==newListOfLessonPlan.SemesterId">{{cl.text}}</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <label>Subject</label>
                                            @*<select class="form-control form-control-sm select2" ng-model="newListOfLessonPlan.SubjectId" ng-change="GetLessonPlanByClassSubjectLLP(newListOfLessonPlan.ClassId,newListOfLessonPlan.SubjectId)">
                    <option ng-value="0">Select Subject</option>
                    <option ng-value="cl.id" ng-repeat="cl in SubjectListLLP" ng-selected="cl.id==newListOfLessonPlan.SubjectId">{{cl.text}}</option>
                </select>*@
                                            <select class="form-control form-control-sm select2" ng-model="newListOfLessonPlan.SubjectId" ng-change="GetLessonPlanByClassSubjectLLP()">
                                                <option ng-repeat="ct in newListOfLessonPlan.SubjectList" value="{{ ct.SubjectId }}" ng-selected="ct.SubjectId==newListOfLessonPlan.SubjectId">
                                                    {{ct.Name}}
                                                </option>
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <div class="tree">
                                    <ul class="card p-0" style="padding-left: 0px;margin-bottom: 6px;">
                                        <!--First Lesson Starts-->
                                        <li ng-repeat="ld in newListOfLessonPlan.DetailsColl">
                                            <span data-toggle="collapse" style=" background-color: #ccecc4;">
                                                <div style="color:#000; text-decoration:none;" data-toggle="collapse"
                                                     href="#topic{{$index}}" aria-expanded="true" aria-controls="topic1">
                                                    <i class="collapsed"><i class="fas fa-folder"></i></i>
                                                    <i class="expanded"><i class="far fa-folder-open"></i></i>
                                                    {{ld.SNo}}. {{ld.LessonName}}<label class="updateDate"><b>&rarr;</b><i> ({{ld.PlanStartDate_BS}} - {{ld.PlanEndDate_BS}})</i> - <b>{{ ld.TotalDays }} Days</b></label>

                                                </div>
                                            </span>
                                            <div id="topic{{$index}}" class="collapse show">
                                                <ul class="pb-3">
                                                    <li ng-repeat="tc in ld.TopicColl">
                                                        <span data-toggle="collapse" style=" background-color: #e7f0e6;">
                                                            <a style="color:#000; text-decoration:none;" data-toggle="collapse"
                                                               href="#subtopic1-{{ld.SNo}}-{{$index}}" aria-expanded="false"
                                                               aria-controls="subtopic1">
                                                                <i class="collapsed"><i class="fas fa-folder"></i></i>
                                                                <i class="expanded"><i class="far fa-folder-open"></i></i>
                                                                {{ld.SNo}}.{{tc.SNo}}. {{tc.TopicName}} <label class="updateDate"><b>&rarr;</b><i> ({{tc.PlanStartDate_BS}} - {{tc.PlanEndDate_BS}})</i>  - <b>{{tc.TotalDays}} Days</b></label>
                                                            </a>

                                                        </span>
                                                        <div id="subtopic1-{{ld.SNo}}-{{$index}}" class="collapse">
                                                            <ul class="pb-3">
                                                                <li ng-repeat="CTTL in tc.ContentsColl">
                                                                    <div class="table-scroll-x-y sales-main-table table-scroll">
                                                                        <table id="main-table" class="main-table table table-sm table-bordered bg-white">
                                                                            <tbody>
                                                                                <tr>
                                                                                    <td style="width: 100px;">{{CTTL.ForDateBS}}</td>
                                                                                    <td>
                                                                                        <div class="card-body p-2" ng-bind-html="CTTL.Contents | unsafe">
                                                                                        </div>
                                                                                    </td>
                                                                                </tr>
                                                                            </tbody>
                                                                        </table>
                                                                    </div>
                                                                </li>
                                                            </ul>
                                                        </div>
                                                    </li>
                                                </ul>
                                            </div>
                                        </li>

                                    </ul>
                                </div>
                            </div>
                            <!--List Of Lesson Plan Ends-->
                        </div>
                    </div>
                </div>

                <!--New Modal Code Added by Suresh on chaitra-30-->
                <div class="modal fade" id="modal-xl">
                    <div class="modal-dialog modal-xl">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h6 class="modal-title">Lesson Plan Detail</h6>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body" style="max-height:500px;overflow-y:auto">
                                <div ng-repeat="gDet in CurrentLessionTopic.ContentsColl">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <div class="form-group d-flex">
                                                <label class="mr-2"><b><span>Date </span></b></label>
                                                <input type="text" date-picker
                                                       class="form-control form-control-sm" ng-model="gDet.ForDate_TMP" date-detail="gDet.ForDateDet">
                                            </div>
                                        </div>
                                        <div class="col-md-12">
                                            <div class="form-group">
                                                <label><b>Teaching Content</b></label>
                                                <textarea class="textarea" placeholder="Place some text here" style="
                                                                          width: 100%;
                                                                          height:150px!important;
                                                                          font-size: 14px;
                                                                          line-height: 18px;
                                                                          border: 1px solid #dddddd;
                                                                          padding: 10px;
                                                                        " ng-model="gDet.Contents" html-editor></textarea>
                                            </div>
                                        </div>

                                    </div>
                                    <div class="mt-0 mb-2">
                                        <button class="btn btn-sm btn-success" ng-click="AddContentDetails($index)">
                                            <i class="fas fa-plus"></i>
                                        </button>
                                        <button class="btn btn-sm btn-danger" ng-click="delContentDetails($index)">
                                            <i class="fas fa-trash-alt"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="time-label">
                                    <span class="d-block border-0 p-3 text-center">

                                        <button type="button" class="btn btn-sm btn-default" style="min-width: 90px;">Reset</button>
                                        <button type="button" class="btn btn-sm btn-success" style="min-width: 90px;" ng-click="CallSaveUpdateLessonTopicTeacherContent()">Save</button>
                                    </span>
                                </div>

                            </div>
                        </div>
                        <!-- /.modal-content -->
                    </div>
                </div>


                <!--New Modal Code Added by Suresh on chaitra-30-->
                <div class="modal fade" id="modal-xl-1">
                    <div class="modal-dialog modal-xl">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h6 class="modal-title">Lesson Plan Detail</h6>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body" style="max-height:500px;overflow-y:auto">
                                <div ng-repeat="gDet in CurrentLessonC.ContentsColl">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <div class="form-group d-flex">
                                                <label class="mr-2"><b><span>Date </span></b></label>
                                                <input type="text" date-picker
                                                       class="form-control form-control-sm" ng-model="gDet.ForDate_TMP" date-detail="gDet.ForDateDet">
                                            </div>
                                        </div>
                                        <div class="col-md-12">
                                            <div class="form-group">
                                                <label><b>Teaching Content</b></label>
                                                <textarea class="textarea" placeholder="Place some text here" style="
                                                                          width: 100%;
                                                                          height:150px!important;
                                                                          font-size: 14px;
                                                                          line-height: 18px;
                                                                          border: 1px solid #dddddd;
                                                                          padding: 10px;
                                                                        " ng-model="gDet.Contents" html-editor></textarea>
                                            </div>
                                        </div>

                                    </div>
                                    <div class="mt-0 mb-2">
                                        <button class="btn btn-sm btn-success" ng-click="AddContentDetails1($index)">
                                            <i class="fas fa-plus"></i>
                                        </button>
                                        <button class="btn btn-sm btn-danger" ng-click="delContentDetails1($index)">
                                            <i class="fas fa-trash-alt"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="time-label">
                                    <span class="d-block border-0 p-3 text-center">

                                        <button type="button" class="btn btn-sm btn-default" style="min-width: 90px;">Reset</button>
                                        <button type="button" class="btn btn-sm btn-success" style="min-width: 90px;" ng-click="CallSaveUpdateLessonTeacherContent()">Save</button>
                                    </span>
                                </div>

                            </div>
                        </div>
                        <!-- /.modal-content -->
                    </div>
                </div>
            </section>
        </div>
    </section>
    <!--Modal for book cover-->
    <div class="modal fade" id="bookcover">
        <div class="modal-dialog modal-md">
            <div class="modal-content">
                <div class="modal-header">
                    <h6 class="modal-title">Book Cover Name</h6>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <img class="img-fluid" ng-src="{{newAddLesson.FilesData || newAddLesson.CoverFilePath}}" style="background-size: cover;" />

                </div>
            </div>
            <!-- /.modal-content -->
        </div>
    </div>
</div>
