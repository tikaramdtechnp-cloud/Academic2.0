<style>
    .iptable td {
        padding: 0.3rem !important
    }
</style>
<script src="~/jslib/Setup/YearClosing.js?v=20251115"></script>
<div class="hold-transition  layout-navbar-fixed" ng-app="myApp" ng-controller="YearClosingController" ng-init="LoadData()">
    <section class="content">
        <div class="container-fluid">
            <section class="iframe-content-starts-here" style="padding-top:50px!important">
                <div class="row">
                    <div class="col-md-12">
                        <div class="card" style="border:1px solid #cad8d2">
                            <div class="card-header p-2" style="background-color: #e9f2ee;">
                                <h3 class="card-title text-secondary"><b>Class Upgrade</b></h3>
                            </div>
                            <div class="card-body p-2">
                                <div class="row">
                                    <div class="col-md-2">
                                        <div class="form-group">
                                            <label>Select Exam</label>
                                            <select class="form-control form-control-sm" ng-model="newYearClosing.ExamAs">
                                                <option ng-value="1">Exam Type</option>
                                                <option ng-value="2">Exam Type Group</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="form-group">
                                            <label>Promote to</label>
                                            <select class="form-control form-control-sm" ng-model="newYearClosing.PromoteTo">
                                                <option ng-value="1">All Student</option>
                                                <option ng-value="2">Pass Student only</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="form-group">
                                            <label>Roll No</label>
                                            <select class="form-control form-control-sm" ng-model="newYearClosing.RollNoAs">
                                                <option ng-value="1">Rankwise</option>
                                                <option ng-value="2">Alphabetically</option>
                                                <option ng-value="3">As Previous RollNo</option>
                                                <option ng-value="4">Set zero (0) to all</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="form-group">
                                            <label>Section</label>
                                            <select class="form-control form-control-sm" ng-model="newYearClosing.SectionAs">
                                                <option ng-value="1">As It's'</option>
                                                <option ng-value="2">RankWise</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="form-group">
                                            <label>From Year</label>
                                            <select class="form-control form-control-sm" ng-model="newYearClosing.FromAcademicYearId">
                                                <option ng-value="c.AcademicYearId" ng-repeat="c in AcademicYearColl">{{c.Name}}</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="form-group">
                                            <label>To Year</label>
                                            <select class="form-control form-control-sm" ng-model="newYearClosing.ToAcademicYearId">
                                                <option ng-value="c.AcademicYearId" ng-repeat="c in AcademicYearColl">{{c.Name}}</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="mt-4">
                                            <button type="button" class="btn btn-sm btn-info" style="min-width: 90px;" ng-click="UpdateAcademicYear()">Default AcademicYear</button>
                                        </div>
                                    </div>

                                    <div class="col-md-2">
                                        <div class="form-group">
                                            @*<label>Cost Class</label>*@
                                            <label>Fiscal Year</label>
                                            <select class="form-control form-control-sm" ng-model="newYearClosing.CostClassId">
                                                <option ng-value="c.CostClassId" ng-repeat="c in CostClassColl">{{c.Name}}</option>
                                            </select>
                                        </div>
                                    </div>
                                    <!--New Field Added By suresh on Magh 13 starts-->

                                    <div class="col-md-2">
                                        <div class="form-group mt-4">
                                            <label class="checkbox-wrap">
                                                Transfer Student Opening
                                                <input type="checkbox" name="transferstdopening" data-ng-value="1" ng-model="newYearClosing.ForwardOpening" />
                                                <span class="checkmark"></span>
                                            </label>

                                        </div>
                                    </div>
                                    <!--Ends-->
                                    <div class="col-md-2" ng-show="newYearClosing.ForwardOpening">
                                        <div class="form-group">
                                            <label>Opening Fee Head</label>
                                            <select class="form-control form-control-sm" ng-model="newYearClosing.OpeningFeeHeadingId">
                                                <option ng-value="c.FeeItemId" ng-repeat="c in FeeItemList">{{c.Name}}</option>
                                            </select>
                                        </div>
                                    </div>
                                    @*<div class="col-md-2">
                                            <div class="form-group mt-4">
                                                <label for="rboAtt1">Forward FeeMapping</label>
                                                <input type="checkbox" class="iradio_flat-green input-sm" name="rboAtt1" data-ng-value="1" ng-model="newYearClosing.ForwardFeeMapping" />

                                            </div>
                                        </div>*@
                                    <div class="col-md-2">
                                        <div class="form-group mt-4">
                                            <label class="checkbox-wrap">
                                                Forward FeeMapping
                                                <input type="checkbox" name="rboAtt1" data-ng-value="1" ng-model="newYearClosing.ForwardFeeMapping" />
                                                <span class="checkmark"></span>
                                            </label>

                                        </div>
                                    </div>
                                    @*<div class="col-md-2">
                                            <div class="form-group mt-4">
                                                <label for="rboAtt2">Forward TransportMapping</label>
                                                <input type="checkbox" class="iradio_flat-green input-sm" name="rboAtt2" data-ng-value="1" ng-model="newYearClosing.ForwardTransportMapping" />

                                            </div>
                                        </div>*@
                                    <div class="col-md-2">
                                        <div class="form-group mt-4">
                                            <label class="checkbox-wrap">
                                                Forward TransportMapping
                                                <input type="checkbox" name="rboAtt2" data-ng-value="1" ng-model="newYearClosing.ForwardTransportMapping" />
                                                <span class="checkmark"></span>
                                            </label>

                                        </div>
                                    </div>
                                    @*<div class="col-md-2">
                                            <div class="form-group mt-4">
                                                <label for="rboAtt3">Forward Hostel Mapping</label>
                                                <input type="checkbox" class="iradio_flat-green input-sm" name="rboAtt3" data-ng-value="1" ng-model="newYearClosing.ForwardBedMapping" />

                                            </div>
                                        </div>*@
                                    <div class="col-md-2">
                                        <div class="form-group mt-4">
                                            <label class="checkbox-wrap">
                                                Forward Hostel Mapping
                                                <input type="checkbox" name="rboAtt3" data-ng-value="1" ng-model="newYearClosing.ForwardBedMapping" />
                                                <span class="checkmark"></span>
                                            </label>

                                        </div>
                                    </div>
                                    @*<div class="col-md-2">
                                            <div class="form-group mt-4">
                                                <label for="rboAtt4">Forward DiscountSetup</label>
                                                <input type="checkbox" class="iradio_flat-green input-sm" name="rboAtt4" data-ng-value="1" ng-model="newYearClosing.ForwardDiscountSetup" />

                                            </div>
                                        </div>*@

                                    <div class="col-md-2">
                                        <div class="form-group mt-4">
                                            <label class="checkbox-wrap">
                                                Forward DiscountSetup
                                                <input type="checkbox" name="ForwardDiscountSetup" data-ng-value="1" ng-model="newYearClosing.ForwardDiscountSetup" />
                                                <span class="checkmark"></span>
                                            </label>

                                        </div>
                                    </div>

                                    <!--added by suresh on magh 13-->
                                    <div class="col-md-2">
                                        <div class="form-group mt-4">
                                            <label class="checkbox-wrap">
                                                Forward Class Schedule
                                                <input type="checkbox" name="forwardclasssc" data-ng-value="1" ng-model="newYearClosing.ForwardClassSchedule" />
                                                <span class="checkmark"></span>
                                            </label>

                                        </div>
                                    </div>


                                    <!--Ends-->
                                    <div class="col-md-2">
                                        <div class="form-group">
                                            <label>Closing Pwd.</label>
                                            <input type="password" class="form-control form-control-sm" ng-model="newYearClosing.Pwd" />
                                        </div>
                                    </div>
                                    @*<div class="col-md-2">

                                        </div>*@
                                    <div class="col-md-3">
                                        <div class="d-flex">
                                            <div class="mt-4">
                                                <button type="button" class="btn btn-sm btn-secondary mr-2" style="min-width: 110px;" ng-click="GenerateOTP()">Generate OTP</button>
                                            </div>
                                            <div class="form-group">
                                                <label>Closing OTP.</label>
                                                <input type="text" class="form-control form-control-sm" ng-model="newYearClosing.OTP" />
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-md-1">
                                        <div class="mt-4 text-right">
                                            <button type="button" class="btn btn-sm btn-success" style="min-width: 60px;" ng-click="SaveUpdateYearClosing()">Upgrade</button>
                                        </div>
                                    </div>
                                </div>

                                <div class="table-scroll-x-y sales-main-table iptable table-scroll">
                                    <table id="main-table"
                                           class="main-table table table-sm table-bordered bg-white">
                                        <thead>
                                            <tr>
                                                <th style="width: 100px;">From Class</th>
                                                <th style="width: 120px;">To Class</th>
                                                <th style="width: 120px;" ng-show="AcademicConfig.ActiveBatch==true">Batch</th>
                                                <th style="width: 100px;" ng-show="AcademicConfig.ActiveClassYear==true || AcademicConfig.ActiveSemester==true">From Year/Semester</th>
                                                <th style="width: 100px;" ng-show="AcademicConfig.ActiveClassYear==true || AcademicConfig.ActiveSemester==true">To Year/Semester</th>
                                                <th style="width: 160px;">Exam Name</th>
                                                <th style="width: 115px;" class="text-center">Action</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr ng-repeat="cl in newYearClosing.ClassColl">
                                                <td>{{cl.text}}</td>
                                                <td>
                                                    <select class="form-control form-control-sm" ng-model="cl.ToClassId">
                                                        <option ng-value="0">**Select Class**</option>
                                                        <option ng-value="c.id" ng-repeat="c in ClassList">{{c.text}}</option>
                                                    </select>
                                                </td>
                                                <td ng-show="AcademicConfig.ActiveBatch==true">
                                                    <select class="form-control form-control-sm" ng-model="cl.BatchId">
                                                        <option ng-value="0">**Select Batch**</option>
                                                        <option ng-value="c.id" ng-repeat="c in BatchList">{{c.text}}</option>
                                                    </select>
                                                </td>
                                                <td ng-show="AcademicConfig.ActiveClassYear==true || AcademicConfig.ActiveSemester==true">
                                                    <select class="form-control form-control-sm" ng-model="cl.FromClassYearId" ng-show="cl.ClassType==2">
                                                        <option ng-value="0">**Select Year**</option>
                                                        <option ng-value="c.id" ng-repeat="c in cl.SelectedClassClassYearList">{{c.text}}</option>
                                                    </select>
                                                    <select class="form-control form-control-sm" ng-model="cl.FromSemesterId" ng-show="cl.ClassType==3">
                                                        <option ng-value="0">**Select Semester**</option>
                                                        <option ng-value="c.id" ng-repeat="c in cl.SelectedClassSemesterList">{{c.text}}</option>
                                                    </select>
                                                </td>
                                                <td ng-show="AcademicConfig.ActiveClassYear==true || AcademicConfig.ActiveSemester==true">
                                                    <select class="form-control form-control-sm" ng-model="cl.ToClassYearId" ng-show="cl.ClassType==2">
                                                        <option ng-value="0">**Select Year**</option>
                                                        <option ng-value="c.id" ng-repeat="c in cl.SelectedClassClassYearList">{{c.text}}</option>
                                                    </select>
                                                    <select class="form-control form-control-sm" ng-model="cl.ToSemesterId" ng-show="cl.ClassType==3">
                                                        <option ng-value="0">**Select Semester**</option>
                                                        <option ng-value="c.id" ng-repeat="c in cl.SelectedClassSemesterList">{{c.text}}</option>
                                                    </select>
                                                </td>
                                                <td ng-show="newYearClosing.ExamAs==1">
                                                    <select class="form-control form-control-sm" ng-model="cl.ExamTypeId">
                                                        <option ng-value="0">**Select ExamType**</option>
                                                        <option ng-value="et.ExamTypeId" ng-repeat="et in ExamTypeList">{{et.Name}}</option>
                                                    </select>
                                                </td>
                                                <td ng-show="newYearClosing.ExamAs==2">
                                                    <select class="form-control form-control-sm" ng-model="cl.ExamTypeGroupId">
                                                        <option ng-value="0">**Select ExamGroup**</option>
                                                        <option ng-value="et.ExamTypeGroupId" ng-repeat="et in ExamTypeGroupList">{{et.Name}}</option>
                                                    </select>
                                                </td>
                                                <!--Added by Suresh on Falgun 26-->
                                                <td class="text-center">
                                                    <div class="custom-control custom-checkbox">
                                                        <input class="custom-control-input" type="checkbox" id="customCheckbox1-{{$index}}"
                                                               ng-model="cl.ForAll" >
                                                        <label for="customCheckbox1-{{$index}}" class="custom-control-label">All</label>
                                                        <button type="button" class="btn btn-sm btn-info ml-2" style="font-size: 13px; padding:1px 10px;"
                                                                ng-click="ShowStudentSelection(cl)">
                                                            Custom
                                                        </button>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    <!-- table end -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </section>
        </div>
    </section>

    <!--Added Modal by Suresh on 26 algun starts-->
    <div class="modal fade" id="modal-custom-student" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" style="margin-top:20px;">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h6>Student List</h6>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <div aria-hidden="true">&times;</div>
                    </button>
                </div>
                <div class="modal-body p-2">
                    <label><b>Please select the students to be promoted or transferred.</b></label>
                    <div class="table-scroll-x-y sales-main-table table-scroll" style="max-height: calc(100vh - 11rem);">
                        <table id="main-table" class="main-table table table-sm table-bordered bg-white">
                            <thead>
                                <tr>
                                    <th style="width: 60px;z-index:3">
                                        <div class="custom-control custom-checkbox">
                                            <input class="custom-control-input" type="checkbox" id="customCheckboxAll"
                                                   ng-model="selectAllStudents" ng-change="CheckedAll(selectAllStudents)">
                                            <label for="customCheckboxAll" class="custom-control-label">SNo</label>
                                        </div>
                                    </th>
                                    <th style="width: 65px">Roll No</th>
                                    <th style="width: 65px">Adm.No</th>
                                    <th style="width: 147px">Name</th>
                                    <th style="width: 130px">Class</th>

                                   
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-repeat="md in StudentColl">
                                    <td>
                                        <div class="custom-control custom-checkbox">
                                            <input class="custom-control-input" type="checkbox" id="customCheckbox-{{$index}}"
                                                   ng-model="md.selected" ng-change="updateSelection()">
                                            <label for="customCheckbox-{{$index}}" class="custom-control-label">{{$index+1}}</label>
                                        </div>
                                    </td>
                                    <td>{{md.RollNo}}</td>

                                    <td>{{md.RegdNo}}</td>
                                    <td>{{md.Name}}</td>
                                    <td>
                                        <span ng-if="md.ClassName">{{md.ClassName}}</span>
                                        <span ng-if="md.Batch"> - {{md.Batch}}</span>
                                        <span ng-if="md.ClassYear"> - {{md.ClassYear}}</span>
                                        <span ng-if="md.Semester"> - {{md.Semester}}</span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <!-- table end -->
                    </div>
                </div>
                <div class="modal-footer1 p-2">
                    <div class="row">
                        <div class="col-md-12 text-center">
                            <button type="button" class="btn btn-sm btn-success" style="min-width: 90px">
                                Save
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>